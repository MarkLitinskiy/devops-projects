# D01_Linux

## Оглавление
1 [Установка ОС](#Part1)  
2 [Создание пользователя](#Part2)  
3 [Настройка сети ОС](#part-3-настройка-сети-ос)   
4 [Обновление ОС](#part-4-обновление-ос)  
5 [Использование команды  sudo](#part-5-использование-команды-sudo)  
6 [Установка и настройка службы времени](#part-6-установка-и-настройка-службы-времени)  
7 [Установка и использование текстовых редакторов](#part-7-установка-и-использование-текстовых-редакторов)  
8 [Установка и базовая настройка сервиса SSHD](#part-8-установка-и-базовая-настройка-сервиса-sshd)   
9 [Установка и использование утилит top, htop](#part-9-установка-и-использование-утилит-top-htop)   
10 [Использование утилиты fdisk](#part-10-использование-утилиты-fdisk)   
11 [Использование утилиты df](#part-11-использование-утилиты-df)    
12 [Использование утилиты du](#part-12-использование-утилиты-du)    
13 [Установка и использование утилиты ncdu](#part-13-установка-и-использование-утилиты-ncdu)    
14 [Работа с системными журналами](#part-14-работа-с-системными-журналами)     
15 [Использование планировщика заданий CRON](#part-15-использование-планировщика-заданий-cron) 



## Part1. Установка ОС <a name="Part1"></a>

1. Установка Ubuntu 20.04 Server LTS без графического интерфейса с использованием VirtualBox.  
Установленная Ubuntu server:  
![Установленная Ubuntu server](part1/pt1.1.png)

## Part2. Создание пользователя <a name="Part2></a>

1. Создание нового пользователя. 
Непосредственное создание пользователя:   
![Непосредственное создание пользователя](part2/pt2.1.png)  
Команда cat /etc/passwd(Скриншот вывода пользователей):  
![Команда cat /etc/passwd(Скриншот вывода пользователей)](part2/pt2.2.png)    
С помощью команды `sudo usermod -a -G adm marcus` добавляем его в группу адм

## Part3. Настройка сети ОС

1. Задать название машины вида пользователь_1 (имя пользователя из Part 2)  
Смена hostname:  
![Смена hostname](part3/pt3.1.png)    
На имя marcus_1 система выдавала ошибку из-за нижнего подчёркивания, поэтому название marcus-1
2. Установить временную зону, соответствующую вашему текущему местоположению.  
Смена временной зоны и вывод актуальной:  
![Смена временной зоны и вывод актуальной](part3/pt3.2.png)  
3. Вывести названия сетевых интерфейсов с помощью консольной команды.  
Список сетевых интерфейсов командой ifconfig:  
![Список сетевых интерфейсов командой ifconfig](part3/pt3.3.png)    
>Сетевой интерфейс lo виртуальный и используется для отладки сетевых программ и запуска серверных приложений на локальной машине.
4. Используя консольную команду получить ip адрес устройства, на котором вы работаете, от DHCP сервера.
Ip-адрес устройства:    
![Ip адрес устройства](part3/pt3.4.png)    
>DHCP - это клиент-серверный протокол динамической конфигурации хоста (Dynamic Host Configuration Protocol), с помощью которого в ИТ-инфраструктуре сетевые параметры каждого нового устройства прописываются автоматически.
5. Определить и вывести на экран внешний ip-адрес шлюза (ip) и внутренний IP-адрес шлюза, он же ip-адрес по умолчанию (gw).
Ip-адресa:  
![Ip адресa](part3/pt3.5.png)    
Красный - внутренний ip адрес, Синий - внешний ip адрес.
6. Задать статичные (заданные вручную, а не полученные от DHCP сервера) настройки ip, gw, dns (использовать публичный DNS серверы, например 1.1.1.1 или 8.8.8.8).  
Файл конфигурации сети:  
![Файл конфигурации сети](part3/pt3.6.png)  
Был создан файл конфигурации сети, в котором прописываются статический ip адрес(10.0.2.15), шлюз(10.0.2.2) и открытые dns сервера(8.8.8.8 и 1.1.1.1)
7. Перезагрузить виртуальную машину. Убедиться, что статичные сетевые настройки (ip, gw, dns) соответствуют заданным в предыдущем пункте.
Результат команды ifconfig и пинг серверов:  
![Результат команды ifconfig и пинг серверов](part3/pt3.7.png)  

## Part4. Обновление ОС

1. Обновить системные пакеты до последней на момент выполнения задания версии.
Обновление через команду `apt-get upgrate`:  
![Обновление через команду apt-get upgrate](part4/pt4.1.png)  

## Part5. Использование команды sudo

1. Разрешить пользователю, созданному в Part 2, выполнять команду sudo.
Даём пользователю права суперпользователя:  
![Даём пользователю права суперпользователя](part5/pt5.1.png)  
Изменяем hostname:  
![Изменяем hostname](part5/pt5.2.png)  
Обновлённый hostname:  
![Обновлённый hostname](part5/pt5.3.png)  

## Part 6. Установка и настройка службы времени

1. Настроить службу автоматической синхронизации времени.
Вывод команды timedatectl show (NTPSynchronized=yes):  
![Вывод команды timedatectl show (NTPSynchronized=yes)](part6/pt6.1.png)  

## Part 7. Установка и использование текстовых редакторов

1. Установить текстовые редакторы VIM (+ любые два по желанию NANO, MCEDIT, JOE и т.д.)
Установлены Vim, Nano и Joe:  
![Установлены Vim, Nano и Joe](part7/pt7.1.png)  
2. Используя каждый из трех выбранных редакторов, создайте файл test_X.txt, где X -- название редактора, в котором создан файл. Напишите в нём свой никнейм, закройте файл с сохранением изменений.
  * Файл Vim:  
  Для закрытия `shift + :` для перехода в режим консоли и вводим wq для сохранения и выхода  
  ![Файл Vim](part7/pt7.2.png)    
  * Файл Nano:  
  Для закрытия `Ctl + o`(сохранение изменений) `Ctl + x`(непосредственно закрытие)  
  ![Файл Nano](part7/pt7.3.png)  
  * Файл Joe:  
  Для закрытия `Ctl + k` (сохранение) `Сtl + x` (закрытие)  
  ![Файл Joe](part7/pt7.4.png)  
3. Используя каждый из трех выбранных редакторов, откройте файл на редактирование, отредактируйте файл, заменив никнейм на строку "21 School 21", закройте файл без сохранения изменений.
  * Изменённый файл Vim:  
  Для выхода без сохранения `shift + :` (переход в режим консоли) и `q!` для принудительного выхода  
  ![Изменённый файл Vim](part7/pt7.5.png)  
  * Изменённый файл Nano:  
  Для выхода без сохранения `Ctl + x` и выбираем No  
  ![Изменённый файл Nano](part7/pt7.6.png)  
  * Изменённый файл Joe:  
  Для выхода без сохранения `Ctl + c` и выбираем Yes (выйти без сохранения)  
  ![Изменённый файл Joe](part7/pt7.7.png)  
4. Используя каждый из трех выбранных редакторов, отредактируйте файл ещё раз (по аналогии с предыдущим пунктом), а затем освойте функции поиска по содержимому файла (слово) и замены слова на любое другое.
  * Файл Vim с найденным словом marcus  (для поиска используется /)  
  ![Файл Vim с найденным словом marcus](part7/pt7.8.png)  
  * Файл Vim с заменой слова marcus на rog  (для замены `:s/искомое/чем заменить`)  
  ![Файл Vim с заменой слова marcus на rog](part7/pt7.9.png)  
  * Файл Nano с найденным словом marcus  (`Ctl + W`)  
  ![Файл Nano с найденным словом marcus](part7/pt7.10.png)  
  * Файл Nano с заменой слова marcus (`Ctl + \`)  
  ![Файл Nano с заменой слова marcus](part7/pt7.11.png)  
  * Файл Joe с найденным словом marcus  (`Ctl + K`) и нажимаем F  
  ![Файл Joe с найденным словом marcus](part7/pt7.12.png)  
  * Файл Joe с заменой слова marcus (после найденного слова нажимаем R(Replace))  
  ![Файл Joe с заменой слова marcus](part7/pt7.13.png)  

## Part 8. Установка и базовая настройка сервиса SSHD

1. Установить службу SSHd.
Open SSH установлен:  
![Open SSH установлен](part8/pt8.1.png)    
2. Добавить автостарт службы при загрузке системы.  
Автостарт добавляется с помощью команды `sudo systemctl enable`, но при установки он сам добавляется в автозагрузку
3. Перенастроить службу SSHd на порт 2022.
В файле конфигурации ssh изменён порт на 2022:  
![В файле конфигурации ssh изменён порт на 2022](part8/pt8.2.png)  
4. Используя команду ps, показать наличие процесса sshd. Для этого к команде нужно подобрать ключи.
Используя команду `ps -A | grep "ssh"` выводим все процессы, связанные с ssh:  
![Команда ps -A | grep "ssh"](part8/pt8.3.png)  
5. Перезагрузить систему.
Результат команды `netstat -tan`:  
![Результат команды netstat -tan](part8/pt8.4.png)    
>Флаг -t это отображение текущего подключения в состоянии переноса нагрузки с процессора на сетевой адаптер при передаче данных  
>Флаг -a это отображение всех подключений и ожидающих портов  
>Флаг -n это отображение адресов и номеров портов в числовом формате  
>Значения столбцов:  
>Proto - имя протокола  
>Local address - локальный IP-адрес, участвующий в соединении или связанный со службой, ожидающей входящие соединения(слушающий порт). Если в качестве адреса отображается 0.0.0.0, то это означает - "любой адрес", то есть в соединении могут использоваться все IP адреса, существующие на данном компьютере.  
>Foreign address - Внешний IP адрес, участвующий в создании соединения.  
>State - состояние соединения. Может быть:  
>CLOSE_WAIT - ожидание закрытия соединения;  
>CLOSED - соединение закрыто;  
>ESTABLISHED - соединение установлено;  
>LISTENING - ожидается соединение (слушается порт);  
>TIME_WAIT - превышение времени ответа.  

## Part 9. Установка и использование утилит top, htop

1. Установить и запустить утилиты top и htop.

- Вывод команды top
  * uptime 
  Время с начала запуска системы:  
  ![Время с начала запуска системы](part9/pt9.1.png)  
  * количество авторизованных пользователей  
  ![количество авторизованных пользователей](part9/pt9.2.png)
  * общую загрузку системы  
  Cредняя загруженность системы одну минуту назад, пять и 15 соответственно  
  ![Общая загрузка системы](part9/pt9.6.png)
  * общее количество процессов
  Кол-во процессов, запущенных, спящих, остановленных  
  ![Общая загрузка системы](part9/pt9.3.png)
  * загрузку cpu  
  Загруженность процессора  
  ![Загруженность процессора](part9/pt9.4.png)
  * загрузку памяти
  Загруженность оперативной памяти(Mem) и файла подкачки(swap)  
  ![Загруженность памяти](part9/pt9.5.png)
  * pid процесса занимающего больше всего памяти
  Сортировка по памяти (Shift + m)  
  ![Сортировка по памяти](part9/pt9.7.png)
  * pid процесса, занимающего больше всего процессорного времени
  Сортировка по процессору (Shift + c)  
  ![Сортировка по памяти](part9/pt9.8.png)
- Вывод команды htop
  * отсортированному по PID, PERCENT_CPU, PERCENT_MEM, TIME
  Сортировка происходит после нажатия клавиши f6 и последующего выбора критерия  
  ![Сортировка по PID](part9/pt9.9.png)  
  ![Сортировка по PERCENT_CPU](part9/pt9.10.png)  
  ![Сортировка по PERCENT_MEM](part9/pt9.11.png)  
  ![Сортировка по TIME](part9/pt9.12.png)  
  * отфильтрованному для процесса sshd
  Фильтр через клавишу `\`  
  ![Сортировка по SSHD](part9/pt9.13.png)
  * с процессом syslog, найденным, используя поиск
  Поиск через клавишу `/`  
  ![Поиск syslog](part9/pt9.14.png)
  * с добавленным выводом hostname, clock и uptime
  ![Вывод](part9/pt9.15.png)

## Part 10. Использование утилиты fdisk

1. Запустить команду fdisk -l.
  * Название диска: /dev/sda;  
  * Размер жёсткого диска: 16Gb;  
  * Кол-во секторов: 33552384;  
  * Размер файла подкачки: 1897468;  
![Вывод инфы по диску](part10/pt10.1.png)

## Part 11. Использование утилиты df

1. Запустить команду df.
![Вывод инфы по диску](part11/pt11.1.png)  
  * размер раздела - 10218772
  * размер занятого места - 4967008
  * размер свободного пространства - 4711092
  * процент использования - 52%
Единица измерения изначально в байтах, но с флагом h в удобном формате.
2. Запустить команду df -Th.
![Вывод инфы по диску](part11/pt11.2.png)  
  * размер раздела - 9.8Gb
  * размер занятого места - 4.8Gb
  * размер свободного пространства - 4.5Gb
  * процент использования - 52%
Тип файловой системы - ext4

## Part 12. Использование утилиты du

1. Запустить команду du
>Команда du позволяет задействовать одноименную утилиту, предназначенную для вывода информации об объеме дискового пространства, занятого файлами и директориями.
2. Вывести размер папок /home, /var, /var/log (в байтах, в человекочитаемом виде)
Размер папки home 64kb  
![Папка home](part12/pt12.1.png)
Размер папки var 737Mb  
![Папка var](part12/pt12.2.png)
Размер папки var/log 37Mb  
![Папка var/log](part12/pt12.3.png)
3. Вывести размер всего содержимого в /var/log (не общее, а каждого вложенного элемента)
Флаг -а показывает вообще все элементы в директориии  
![Папка var/log](part12/pt12.4.png)

## Part 13. Установка и использование утилиты ncdu

1. Установить утилиту ncdu.
![Установка ncdu](part13/pt13.1.png)
2. Вывести размер папок /home, /var, /var/log.
  * Папка home:  
  ![Папка home](part13/pt13.2.png)  
  * Папка var:  
  ![Папка var](part13/pt13.3.png)  
  * Папка var/log:  
  ![Папка var/log](part13/pt13.4.png)  

## Part 14. Работа с системными журналами

1. /var/log/dmesg
Журнал с сообщениями из ядра системы:  
![/var/log/dmesg](part14/pt14.1.png)  
2. /var/log/syslog
Журнал с сообщениями о системных событиях разных пользователей  
![/var/log/syslog](part14/pt14.2.png)
3. /var/log/auth.log
Журнал с сообщениями о входах в систему
![/var/log/auth.log](part14/pt14.3.png)  
Последняя успешная авторизация была осуществлена пользователем abalonef 28 января в 17:51:12 с root правами для доступа к команде ncdu.  
Логи после рестарта службы ssh:  
![/var/log/auth.log](part14/pt14.4.png)

## Part 15. Использование планировщика заданий CRON

1. Используя планировщик заданий, запустите команду uptime через каждые 2 минуты.
Список текущих заданий через команду `crontab -l`  
![crontab -l](part15/pt15.2.png)  
Отчёт в журнале о выполнении:  
![crontab](part15/pt15.1.png)
2. Удалите все задания из планировщика заданий.
Через команду `crontab -r` удаляем все задачи:  
![crontab](part15/pt15.3.png)

